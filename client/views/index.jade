doctype html
html(lang='en', ng-app='angular-client-side-auth')
	head
		meta(charset='utf-8')
		title Angular Auth Example
		link(href="/components/bootstrap/dist/css/bootstrap.css", rel="stylesheet")
		link(href="/components/font-awesome/css/font-awesome.css", rel="stylesheet")

		link(href='/css/app.css', rel='stylesheet')

		// This is needed because Facebook login redirects add #_=_ at the end of the URL
		script(type="text/javascript").
				if (window.location.href.indexOf('#_=_') > 0) {
						window.location = window.location.href.replace(/#.*/, '');
				}

	body(ng-cloak)
		.navbar(ng-controller="NavCtrl")
			.navbar-inner
				.container-fluid
					ul.nav.nav-tabs
						li(access-level='accessLevels.anon', active-nav)
							a(href='/login') Log in
						li(access-level='accessLevels.anon', active-nav)
							a(href='/register') Register
						li(access-level='accessLevels.user', active-nav)
							a(href='/') Home
						li(access-level='accessLevels.user', active-nav='nestedTop')
							a(href='/private') Private
						li(access-level='accessLevels.admin', active-nav)
							a(href='/admin') Admin
						li(access-level='accessLevels.user')
							a(href="", ng-click="logout()")
								| Log out
						div#userInfo.pull-right(access-level='accessLevels.user')
							| Welcome&nbsp;
							strong {{ user.username }}&nbsp;
							span.label(ng-class='{"label-info": user.role.title == userRoles.user.title, "label-success": user.role.title == userRoles.admin.title}') {{ user.role.title }}

		.container(ui-view)

		#alertBox.alert.alert-danger(ng-show="error")
			button(type="button", class="close", ng-click="error = null;") &times;
			strong Oh no!&nbsp;
			span(ng-bind="error")

		script(src='/components/angular/angular.js')
		script(src='/components/angular-cookies/angular-cookies.js')
		script(src='/components/angular-bootstrap/ui-bootstrap-tpls.js')
		script(src='/components/angular-ui-router/release/angular-ui-router.js')
		script(src='/components/angular-animate/angular-animate.js')
		script(src='/js/routingConfig.js')
		script(src='/js/app.js')
		script(src='/js/services.js')
		script(src='/js/controllers.js')
		script(src='/js/filters.js')
		script(src='/js/directives.js')

		// Partial views... Load up front to make transitions smoother
		script(type="text/ng-template", id="survey")
			include partials/surveyHome
		script(type="text/ng-template", id="404")
			include partials/404
		script(type="text/ng-template", id="admin")
			include partials/admin
		script(type="text/ng-template", id="home")
			include partials/home
		script(type="text/ng-template", id="login")
			include partials/login
		script(type="text/ng-template", id="private/layout")
			include partials/private/layout
		script(type="text/ng-template", id="private/home")
			include partials/private/home
		script(type="text/ng-template", id="private/nested")
			include partials/private/nested
		script(type="text/ng-template", id="private/nestedAdmin")
			include partials/private/nestedAdmin
		script(type="text/ng-template", id="register")
			include partials/register
